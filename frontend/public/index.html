<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üöÄ</text></svg>">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="TLAirways - Premium Air Travel Experience"
    />
    
    <!-- Content Security Policy for Auth0 and Adobe Analytics -->
    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self';
      script-src 'self' 'unsafe-inline' 'unsafe-eval' 
        https://dev-q6p3jrm5pbykuq23.us.auth0.com 
        https://assets.adobedtm.com 
        https://*.adobedtm.com;
      style-src 'self' 'unsafe-inline' 
        https://fonts.googleapis.com 
        https://dev-q6p3jrm5pbykuq23.us.auth0.com;
      font-src 'self' 
        https://fonts.gstatic.com 
        https://dev-q6p3jrm5pbykuq23.us.auth0.com;
      img-src 'self' data: blob: 
        https://dev-q6p3jrm5pbykuq23.us.auth0.com 
        https://assets.adobedtm.com 
        https://*.adobedtm.com 
        https://images.unsplash.com 
        https://*.unsplash.com 
        https://www.gravatar.com 
        https://*.gravatar.com;
      connect-src 'self' 
        https://dev-q6p3jrm5pbykuq23.us.auth0.com 
        https://*.auth0.com 
        https://api.tlairways.com 
        https://assets.adobedtm.com 
        https://*.adobedtm.com 
        https://*.adobe.com 
        https://*.demdex.net 
        https://adobedc.demdex.net 
        https://edge.adobedc.net;
      frame-src 'self' 
        https://dev-q6p3jrm5pbykuq23.us.auth0.com 
        https://*.auth0.com 
        https://assets.adobedtm.com 
        https://*.adobedtm.com;
      object-src 'none';
      base-uri 'self';
      form-action 'self' https://dev-q6p3jrm5pbykuq23.us.auth0.com;
    ">
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <title>TLAirways</title>

    <!-- Adobe Target Pre-hiding Snippet -->
    <script>
      (function(e,a,n,t){
        var i=e.head;
        if(i){
          if(a) return;
          var o=e.createElement("style");
          o.id="alloy-prehiding",o.innerText=n,i.appendChild(o),setTimeout(function(){o.parentNode&&o.parentNode.removeChild(o)},t)
        }
      })(document, document.location.href.indexOf("adobe_authoring_enabled") !== -1, ".personalization-container { opacity: 0 !important }", 3000);
    </script>
    
    <!-- Adobe Launch/DTM Script - Dynamic Loading based on User Preference -->
    <script>
      (function() {
        // Default Adobe Launch script URL and attributes
        var defaultScriptUrl = 'https://assets.adobedtm.com/01296dd00565/26201e3c8f15/launch-2f8b80d50cb3-development.min.js';
        var defaultAttributes = {
          async: true,
          crossOrigin: 'anonymous'
        };
        
        // Check localStorage for custom script URL and attributes
        var customScriptUrl = null;
        var customAttributes = null;
        
        try {
          customScriptUrl = localStorage.getItem('tlairways_adobe_script_url');
          var storedAttrs = localStorage.getItem('tlairways_adobe_script_attributes');
          customAttributes = storedAttrs ? JSON.parse(storedAttrs) : null;
        } catch (e) {
          console.warn('Could not access localStorage for Adobe script preference:', e);
        }
        
        // Use custom script if available, otherwise use default
        var scriptUrl = customScriptUrl || defaultScriptUrl;
        var scriptAttributes = customAttributes || defaultAttributes;
        
        // Create and load the script with attributes
        var script = document.createElement('script');
        script.src = scriptUrl;
        
        // Apply attributes
        if (scriptAttributes.async) {
          script.async = true;
        }
        if (scriptAttributes.defer) {
          script.defer = true;
        }
        if (scriptAttributes.crossOrigin) {
          script.crossOrigin = scriptAttributes.crossOrigin;
        }
        
        script.onload = function() {
          console.log('‚úÖ Adobe Launch script loaded:', scriptUrl);
          console.log('‚úÖ Script attributes:', scriptAttributes);
        };
        
        script.onerror = function() {
          console.error('‚ùå Failed to load Adobe Launch script:', scriptUrl);
          // Fallback to default if custom script fails
          if (customScriptUrl && scriptUrl !== defaultScriptUrl) {
            console.log('üîÑ Attempting to load default script...');
            var fallbackScript = document.createElement('script');
            fallbackScript.src = defaultScriptUrl;
            fallbackScript.async = true;
            fallbackScript.crossOrigin = 'anonymous';
            document.head.appendChild(fallbackScript);
          }
        };
        
        document.head.appendChild(script);
      })();
    </script>

    <!-- Adobe Target helper utilities for SPA view tracking -->
    <script>
      (function (window) {
        if (!window) {
          return;
        }

        var MAX_ATTEMPTS = 10;
        var RETRY_DELAY = 400;

        window.__tlTargetPageParams = window.__tlTargetPageParams || {
          pageName: 'home',
          pageType: 'landing',
          siteSection: 'homepage'
        };

        if (typeof window.targetPageParamsAll !== 'function') {
          window.targetPageParamsAll = function () {
            return window.__tlTargetPageParams || {};
          };
        }

        window.TLAirwaysTarget = window.TLAirwaysTarget || {};

        window.TLAirwaysTarget.setPageParams = function setPageParams(params) {
          window.__tlTargetPageParams = Object.assign(
            {},
            window.__tlTargetPageParams || {},
            params || {}
          );

          return window.__tlTargetPageParams;
        };

        window.TLAirwaysTarget.triggerView = function triggerView(viewName, data, attempt) {
          if (!viewName) {
            return false;
          }

          attempt = attempt || 0;
          var target = window.adobe && window.adobe.target;

          if (target && typeof target.triggerView === 'function') {
            try {
              target.triggerView(viewName, data || {});
              console.log('‚úÖ Adobe Target view triggered:', viewName, data || {});
              return true;
            } catch (error) {
              console.error('‚ùå Adobe Target triggerView failed:', error);
              return false;
            }
          }

          if (attempt >= MAX_ATTEMPTS) {
            console.warn('‚ö†Ô∏è Adobe Target triggerView unavailable for', viewName);
            return false;
          }

          setTimeout(function () {
            triggerView(viewName, data, attempt + 1);
          }, RETRY_DELAY);

          return false;
        };

        var onDomReady = function () {
          var locale = window.navigator ? window.navigator.language : 'en-US';

          window.TLAirwaysTarget.setPageParams({
            language: locale
          });

          window.TLAirwaysTarget.triggerView('home', {
            pageName: 'home',
            siteSection: 'homepage',
            language: locale
          });
        };

        if (document.readyState === 'complete' || document.readyState === 'interactive') {
          onDomReady();
        } else {
          document.addEventListener('DOMContentLoaded', onDomReady, { once: true });
        }
      })(window);
    </script>

  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
  </body>
</html> 